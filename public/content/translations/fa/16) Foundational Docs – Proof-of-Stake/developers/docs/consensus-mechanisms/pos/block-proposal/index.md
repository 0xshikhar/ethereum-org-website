---
title: پیشنهاد بلوک
description: توضیح نحوه پیشنهاد بلوک ها در اتریوم اثبات سهام.
lang: fa
---

بلوک ها واحدهای بنیادین بلاک چین هستند. بلوک‌ها واحدهای مجزای اطلاعاتی هستند که بین گره‌ها رد و بدل می‌شوند، مورد توافق قرار می‌گیرند و به پایگاه داده هر گره اضافه می‌شوند. در این صفحه نحوه ایجاد آنها توضیح داده می‌شود.

## پیش‌نیازها {#prerequisites}

پیشنهاد بلوک بخشی از پروتکل اثبات سهام است. برای کمک به فهمیدن توضیحات این صفحه، توصیه می کنیم در مورد [اثبات سهام](/developers/docs/consensus-mechanisms/pos/) و [معماری بلوک](/developers/docs/blocks/) مطالعه کنید.

## چه کسی بلوک ها را ایجاد می کند؟ {#who-produces-blocks}

حساب های اعتبارسنج بلوک ها را پیشنهاد می کنند. حساب‌های اعتبارسنج توسط اپراتورهای گره‌ مدیریت می‌شوند که نرم‌افزار اعتبارسنجی را به عنوان بخشی از کاربرهای اجرا و اجماع خود اجرا می‌کنند و حداقل 32 اتر را در قرارداد سپرده‌گذاری کرده‌اند. با این حال، هر اعتبارسنج فقط بعضا مسئول پیشنهاد یک بلوک است. اتریوم زمان را در اسلات ها و ایپوک‌ها اندازه گیری می کند. هر اسلات دوازده ثانیه است و 32 اسلات (6.4 دقیقه) یک ایپوک را تشکیل می دهند. هر اسلات فرصتی برای افزودن یک بلوک جدید به اتریوم است.

### انتخاب تصادفی {#random-selection}

در هر اسلات، به صورت شبه‌تصادفی یک اعتبارسنج واحد برای پیشنهاد یک بلوک انتخاب می‌شود. در یک بلاکچین، تصادفی بودن واقعی وجود ندارد، زیرا اگر هر گره اعداد کاملاً تصادفی تولید کند، نمی‌توانند به اجماع برسند. به جای آن، هدف این است که فرآیند انتخاب ولیدیتور غیرقابل پیش‌بینی باشد. تصادفی‌سازی در اتریوم با استفاده از الگوریتمی به نام RANDAO انجام می‌شود که یک هش از پیشنهاددهنده بلوک را با یک بذر که در هر بلوک به‌روز می‌شود، ترکیب می‌کند. این مقدار برای انتخاب یک اعتبارسنج خاص از کل مجموعه ولیدیتورها استفاده می‌شود. انتخاب اعتبارسنج دو دوره زمانی قبل از آن تعیین می‌شود تا از انواع خاصی از دستکاری بذر جلوگیری شود.

اگرچه ولیدیتورها در هر اسلات به RANDAO اضافه می‌کنند، اما مقدار جهانی RANDAO فقط یک بار در هر دوره به‌روز می‌شود. برای محاسبه شاخص پیشنهاددهنده بلوک بعدی، مقدار RANDAO با شماره اسلات ترکیب می‌شود تا یک مقدار منحصر به فرد در هر اسلات ایجاد شود. احتمال انتخاب یک اعتبارسنج خاص تنها `1/N` نیست (که در آن `N` = مجموع اعتبارسنج‌های فعال است). در عوض، این احتمال با توجه به مانده مؤثر ETH هر اعتبارسنج ارزیابی می‌شود. حداکثر مانده مؤثر 32 ETH است (این بدان معناست که `مانده < 32 ETH` منجر به وزن کمتری نسبت به `balance == 32 ETH` می شود، اما `مانده > >32 ETH می شود. ETH` منجر به وزن بالاتر از `مانده == 32 ETH`) نمی شود.

فقط یک پیشنهاد بلوک در هر اسلات انتخاب می شود. در شرایط عادی، یک تولیدکننده بلوک واحد، یک بلوک واحد را در اسلات اختصاصی خود ایجاد و منتشر می‌کند. ایجاد دو بلوک برای یک اسلات، تخطی قابل تنبیه است که اغلب به عنوان "تردید" شناخته می‌شود.

## بلوک چگونه ایجاد می شود؟ {#how-is-a-block-created}

انتظار می‌رود پیشنهاددهنده بلوک، یک بلوک بیکن امضا شده را منتشر کند که بر اساس آخرین سر بلوک زنجیره طبق نظر الگوریتم انتخاب فورک محلی خود ساخته شده است. الگوریتم انتخاب فورک، هرگونه تصدیق در صف مانده از اسلات قبلی را اعمال می‌کند، سپس بلوکی را پیدا می‌کند که بیشترین وزن انباشته تصدیق‌ها را در تاریخچه خود دارد. آن بلوک، والد بلوک جدید ایجاد شده توسط پیشنهاد دهنده است.

پیشنهاددهنده بلوک با جمع‌آوری داده‌ها از پایگاه داده محلی و دیدگاه خود از زنجیره، یک بلوک ایجاد می‌کند. محتویات بلوک در کادر زیر نشان داده شده است:

```rust
class BeaconBlockBody(Container):
    randao_reveal: BLSSignature
    eth1_data: Eth1Data
    graffiti: Bytes32
    proposer_slashings: List[ProposerSlashing, MAX_PROPOSER_SLASHINGS]
    attester_slashings: List[AttesterSlashing, MAX_ATTESTER_SLASHINGS]
    attestations: List[Attestation, MAX_ATTESTATIONS]
    deposits: List[Deposit, MAX_DEPOSITS]
    voluntary_exits: List[SignedVoluntaryExit, MAX_VOLUNTARY_EXITS]
    sync_aggregate: SyncAggregate
    execution_payload: ExecutionPayload
```

فیلد `randao_reveal` یک مقدار تصادفی قابل تأیید را می گیرد که پیشنهاد دهنده بلوک، با امضا کردن شماره ایپوک فعلی ایجاد می کند. `eth1_data` رأیی است برای دیدگاه پیشنهاددهنده بلوک در مورد قرارداد سپرده، از جمله ریشه درخت سپرده Merkle و تعداد کل سپرده‌هایی که امکان تأیید سپرده‌های جدید را فراهم می‌کنند. `graffiti` یک فیلد اختیاری است که می‌توان از آن برای افزودن پیام به بلوک استفاده کرد. `slashings_proposer` و `attester_slashings` فیلدهایی هستند که حاوی اثباتی هستند که نشان می‌دهد اعتبارسنج‌های خاصی طبق دیدگاه پیشنهاددهنده از زنجیره، تخطی‌های قابل تنبیه را مرتکب شده‌اند. `deposits`لیستی از سپرده‌های اعتبارسنج جدید است که پیشنهاددهنده بلوک از آن آگاه است، و `voluntary_exits` لیستی از اعتبارسنج‌هایی است که قصد خروج دارند و پیشنهاددهنده بلوک از طریق شبکه شایعه لایه اجماع از آن مطلع شده است. `sync_aggregate` یک بردار است که نشان می‌دهد کدام اعتبارسنج‌ها قبلاً به یک کمیته همگام‌سازی (زیرمجموعه‌ای از اعتبارسنج‌ها که داده‌های کاربر سبک را ارائه می‌دهند) اختصاص داده شده‌اند و در امضای داده‌ها شرکت کرده‌اند.

`execution_payload` امکان انتقال اطلاعات در مورد تراکنش‌ها بین کاربرهای اجرا و اجماع را فراهم می‌کند. `execution_payload` بلوکی از داده‌های اجرایی است که در داخل یک بلوک بیکن قرار می‌گیرد. فیلدهای داخل `execution_payload` ساختار بلوک مشخص شده در یلو پیپر اتریوم را منعکس می‌کنند، با این تفاوت که هیچ Ommer وجود ندارد و `prev_randao` به جای `difficulty` وجود دارد. کاربر اجرا به یک استخر محلی از تراکنش‌هایی که درباره‌اش در شبکه شایعه خود شنیده است، دسترسی دارد. این تراکنش‌ها به صورت محلی اجرا می‌شوند تا یک درخت حالت به‌روز شده به نام پسا-حالت تولید کنند. تراکنش‌ها به عنوان یک لیست به نام `transactions` در `execution_payload` گنجانده شده‌اند و پسا-حالت در فیلد `state-root` ارائه شده است.

همه این داده‌ها در یک بلوک بیکن جمع‌آوری می‌شوند، امضا می‌شوند و برای همتایان پیشنهادکننده بلوک پخش می‌شوند، که آن‌ها آن را به همتایان خود و غیره منتشر می‌کنند.

درباره [آناتومی بلوک ها](/developers/docs/blocks) بیشتر بخوانید.

## چه اتفاقی برای بلوک می افتد؟ {#what-happens-to-blocks}

بلوک به پایگاه داده محلی پیشنهاددهنده بلوک اضافه می‌شود و از طریق شبکه شایعه لایه اجماع به همتایان پخش می‌شود. هنگامی که یک اعتبارسنج بلوک را دریافت می‌کند، داده‌های داخل آن را تأیید می‌کند، از جمله بررسی اینکه بلوک والد صحیحی دارد، مربوط به اسلات صحیح است، شاخص پیشنهاددهنده مورد انتظار است، آشکارسازی RANDAO معتبر است و پیشنهاددهنده تنبیه نشده است. `execution_payload` باز می‌شود و کاربر اجرای اعتبارسنج تراکنش‌ها را در لیست مجدداً اجرا می‌کند تا تغییر حالت پیشنهادی را بررسی کند. با فرض اینکه بلوک تمام این بررسی‌ها را پاس کند، هر اعتبارسنج بلوک را به زنجیره اصلی خود اضافه می‌کند. سپس این فرآیند در اسلات بعدی دوباره شروع می شود.

## پاداش‌های بلوک {#block-rewards}

پیشنهاددهنده بلوک برای کار خود پاداش دریافت می‌کند. یک پاداش پایه `base_reward` وجود دارد که به عنوان تابعی از تعداد اعتبارسنج‌های فعال و مانده‌های مؤثر آن‌ها محاسبه می‌شود. سپس پیشنهاد دهنده بلوک کسری از `پایه_پاداش` را برای هر تصدیق معتبر موجود در بلوک دریافت می کند. هرچه اعتبارسنج‌های بیشتری بلوک را تصدیق کنند، پاداش پیشنهاد دهنده بلوک بیشتر است. همچنین پاداشی برای گزارش اعتبارسنج‌هایی که باید تنبیه شوند وجود دارد که برابر با `1/512 * مانده مؤثر` برای هر اعتبارسنج تنبیه شده است.

[ اطلاعات بیشتر در مورد پاداش‌ها و مجازات‌ها](/developers/docs/consensus-mechanisms/pos/rewards-and-penalties)

## بیشتر بخوانید {#further-reading}

- [مقدمه‌ای بر بلوک‌ها](/developers/docs/blocks/)
- [مقدمه‌ای بر اثبات سهام](/developers/docs/consensus-mechanisms/pos/)
- [مشخصات اجماع اتریوم](https://github.com/ethereum/consensus-specs)
- [مقدمه‌ای بر Gasper](/developers/docs/consensus-mechanisms/pos/)
- [ارتقای اتریوم](https://eth2book.info/)
