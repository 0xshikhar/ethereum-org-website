---
title: اثبات سهام (PoS)
description: توضیحی درباره‌ی پروتکل اجماع اثبات سهام و نقش آن در اتریوم.
lang: fa
---

اثبات سهام (PoS) زیربنای [مکانیزم اجماع](/developers/docs/consensus-mechanisms/) اتریوم است. اتریوم در سال ۲۰۲۲ به مکانیزم اثبات سهام خود سوییچ کرد؛ زیرا در مقایسه با معماری [اثبات کار](/developers/docs/consensus-mechanisms/pow) قبلی، امن تر، کم مصرف تر و برای پیاده‌سازی راهکارهای مقیاس‌پذیری جدید بهتر است.

## پیش‌نیازها {#prerequisites}

برای درک بهتر این صفحه،‌ ما پیشنهاد می‌کنیم ابتدا [مکانیزم‌های اجماع](/developers/docs/consensus-mechanisms/) را بخوانید.

## اثبات سهام (PoS) چیست؟ {#what-is-pos}

اثبات سهام راهی برای اثبات این موضوع است که اعتبارسنج‌ها چیزی ارزشمند را در شبکه قرار داده اند که اگر غیر صادقانه عمل کنند، می تواند از بین برود. در اثبات سهام اتریوم، اعتبارسنج‌ها به طور مشخص سرمایه‌ خود را به شکل ETH در یک قرارداد هوشمند بر روی اتریوم سهام‌گذاری می‌کنند. اعتبارسنج موظف است بررسی کند که بلوک‌هایی که در شبکه پخش می‌شوند معتبر هستند و هر از گاهی خود بلوک جدیدی ساخته و در شبکه پخش کند. اگر آن ها سعی کنند از شبکه کلاهبرداری کنند (برای مثال با پیشنهاد چند بلوک در زمانی که باید یک بلوک را بفرستند یا تصدیق های متناقض ارسال کنند)، برخی ETH های سهام گذاری شده آنها یا همه آنها ممکن است از بین بروند.

## اعتبارسنج‌ها {#validators}

برای شرکت به‌عنوان اعتبارسنج، کاربر باید 32 اتر را به قرارداد سپرده واریز کند و سه نرم‌افزار مجزا را اجرا کند: یک کاربر اجرا، یک کاربر اجماع، و یک کاربر اعتبارسنج. هنگام سپرده‌گذاری ETHها، کاربر به یک صف فعال‌‌سازی می‌پیوندد که نرخ تعداد اعتبارسنج‌هایی را که به شبکه‌ می‌پیوندند محدود می‌کند. زمانی که اعتبارسنج فعال شد، از همتایان درون شبکه‌ اتریوم بلوک‌های جدید را دریافت می‌کند. تراکنش‌های تحویل شده در بلوک مجدداً اجرا می‌شوند تا بررسی شود که تغییرات پیشنهادی در وضعیت اتریوم معتبر هستند و امضای بلوک بررسی می‌شود. سپس اعتبارسنج یک رای را (که تصدیق نامیده می‌شود) بر روی شبکه برای آن بلوک ارسال می‌کند.

در حالی که در اثبات کار، زمان بلوک‌ها توسط سختی استخراج مشخص می‌شود، در اثبات سهام نرخ ثبت بلوک ثابت است. در اتریوم اثبات سهام، زمان به اسلات‌ها (۱۲ ثانیه) و ایپوک‌ها (۳۲ اسلات) تقسیم می‌شود. یک اعتبارسنج به طور تصادفی برای یک پیشنهادکننده‌ بلوک در هر اسلات انتخاب می‌شود. این اعتبارسنج مسئول ساختن بلوک‌های جدید و فرستادن آن به دیگر گره‌های شبکه است. همچنین در هر اسلات، یک کمیته از اعتبارسنج‌ها به طور تصادفی انتخاب می‌شود، که رای‌های آن‌ برای معتبر بودن بلوک پیشنهاد‌ شده استفاده می‌شود. تقسیم کردن اعتبارسنج در کمیته های ایجاد شده برای قابل مدیریت نگه داشتن بار شبکه مهم است. کمیته ها مجموعه اعتبارسنج را به گونه ای تقسیم می کنند که هر اعتبارسنج فعال در هر ایپوک تصدیق می شود، نه در هر اسلات.

## چگونه یک تراکنش در اتریوم PoS اجرا می شود {#transaction-execution-ethereum-pos}

در ادامه، یک توضیح کامل در مورد نحوه اجرای یک تراکنش در اثبات سهام اتریوم ارائه می شود.

1. کاربر یک [تراکنش](/developers/docs/transactions/) را با کلید خصوصی خود ایجاد و امضا می کند. این کار معمولا توسط یک کیف پول یا یک کتابخانه مانند [ether.js](https://docs.ethers.io/v5/) و [web3js](https://docs.web3js.org/) و [web3py](https://web3py.readthedocs.io/en/v5/) و غیره انجام می شود اما کاربر به صورت پنهانی با استفاده از [JSON-RPC API](/developers/docs/apis/json-rpc/) درخواستی را به یک گره می دهد. کاربر می‌تواند مقدار گازی که تمایل دارد به عنوان انعام به یک اعتبارسنج پرداخت کند را تعریف کند تا او را تشویق کند تراکنش را در یک بلوک قرار دهد. [انعام](/developers/docs/gas/#priority-fee) در حالی به اعتبارسنج پرداخت می شود که [کارمزد پایه](/developers/docs/gas/#base-fee) سوزانده می شود.
2. تراکنش به یک [کاربر اجرای](/developers/docs/nodes-and-clients/#execution-client) اتریوم ارسال می‌شود که اعتبار آن را بررسی می کند. این به معنای اطمینان از این است که فرستنده ETH کافی برای انجام تراکنش دارد و آن را با کلید صحیح امضا کرده است.
3. اگر تراکنش معتبر باشد، کاربر اجرا آن را به استخر حافظه محلی خود (فهرست تراکنش‌های معلق) اضافه می‌کند و همچنین آن را به گره‌های دیگر از طریق شبکه شایعه لایه اجرا پخش می‌کند. هنگامی که گره‌های دیگر در مورد تراکنش می‌شنوند، آن را به استخر حافظه محلی خود نیز اضافه می‌کنند. کاربران پیشرفته ممکن است از پخش تراکنش خودداری کنند و در عوض آن را به سازندگان بلوک تخصصی مانند [Flashbots Auction](https://docs.flashbots.net/flashbots-auction/overview) ارسال کنند. این مورد به آنها اجازه می‌دهد تا تراکنش‌ها را در بلوک‌های آینده برای حداکثر سود سازماندهی کنند ([MEV](/developers/docs/mev/#mev-extraction)).
4. یکی از گره‌های اعتبارسنج در شبکه، پیشنهاددهنده بلوک برای اسلات فعلی است که قبلاً به صورت شبه تصادفی با استفاده از RANDAO انتخاب شده است. این گره مسئول ساخت و پخش بلوک بعدی است که به بلاکچین اتریوم اضافه می‌شود و وضعیت جهانی را به روز می‌کند. گره از سه بخش تشکیل شده است: یک کاربر اجرا، یک کاربر اجماع و یک کاربر اعتبارسنج. کاربر اجرا تراکنش‌ها را از استخر حافظه محلی به یک "پی لود اجرا" بسته بندی می‌کند و آنها را به صورت محلی اجرا می‌کند تا یک تغییر حالت ایجاد کند. این اطلاعات به مشتری اجماع منتقل می‌شود که در آن پی لود اجرا به عنوان بخشی از یک "بلوک بیکون" رپد می‌شود که همچنین حاوی اطلاعاتی در مورد پاداش‌ها، جریمه‌ها، اسلشینگ‌ها، تصدیق ها و غیره است که شبکه را قادر می‌سازد بر روی توالی بلوک‌ها در سر زنجیره توافق کند. ارتباط بین کاربران اجرا و اجماع با جزئیات بیشتر در [اتصال کاربران توافق و اجرا](/developers/docs/networking-layer/#connecting-clients) توضیح داده شده است.
5. گره‌های دیگر، بلوک بیکن جدید را در شبکه شایعه لایه اجماع دریافت می‌کنند. آنها آن را به کاربر اجرای خود ارسال می‌کنند که در آن تراکنش‌ها به صورت محلی مجدداً اجرا می‌شوند تا اطمینان حاصل شود که تغییر حالت پیشنهادی معتبر است. سپس کاربر اعتبارسنج تأیید می‌کند که بلوک معتبر و در دید آنها از زنجیره، بلوک منطقی بعدی است (به این معنی است که بر روی زنجیره ای با بیشترین حجم از تأییدیه ها ساخته می‌شود که در [قوانین انتخاب فورک](/developers/docs/consensus-mechanisms/pos/#fork-choice) تعریف شده). بلوک مدنظر، در دیتابیس محلی هر گره که آن را تأیید کند اضافه می‌شود.
6. اگر تراکنش بین دو نقطه بررسی با "پیوند اکثریت مطلق" بخشی از یک زنجیره شود، می‌ تواند "نهایی شده" در نظر گرفته شود. نقاط بررسی در آغاز هر ایپوک اتفاق می‌افتد و آنها برای توضیح این واقعیت وجود دارند که فقط یک زیرمجموعه از اعتبارسنج‌های فعال در هر اسلات تأییدیه ارائه می‌دهند، اما تمام اعتبارسنج‌های فعال در طول هر ایپوک‌ تأییدیه می‌دهند. از این رو، تنها بین ایپوک‌ها است که می‌توان یک "پیوند اکثریت مطلق" را نشان داد (این جایی است که 66% از همه ETH های استیک شده بر روی شبکه‌ روی دو نقطه بررسی توافق می‌کنند).

جزئیات بیشتر در مورد قطعیت را در زیر ملاحظه می‌کنید.

## قطعیت {#finality}

یک تراکنش در شبکه‌ توزیع‌شده زمانی «قطعیت» دارد که عضوی از بلوکی باشد که نتوان با مصرف کردن میزان قابل‌توجهی ETH آن را عوض کرد. در اتریومِ اثبات سهام، این موضوع با استفاده از بلوک‌های «نقطه‌ بررسی» مدیریت می‌شود. اولین بلوک در هر ایپوک یک نقطه‌ بررسی است. اعتبارسنج‌ها به جفت نقطه‌های بررسی که معتبر می‌دانند رأی می‌دهند. اگر یک جفت نقطه‌ بررسی رأی نماینده‌ دست‌کم دو سوم کل ETH سهام‌گذاری‌شده را داشته باشد، نقطه‌های بررسی ارتقا پیدا می‌کنند. هر کدام که متأخرتر باشد (هدف) «موجه» در نظر گرفته می‌شود. آن یکی که قدیمی‌تر است موجه در نظر گرفته شده است چون «هدف» ایپوک قبلی بوده است. حالا وضعیت آن به «نهایی‌شده» ارتقا یافته است.

برای برگرداندن یک بلوک نهایی، یک مهاجم متعهد می‌شود که حداقل یک‌سوم از کل عرضه ETH سهام‌گذاری‌شده را از دست بدهد. دلیل دقیق این موضوع [در این پست وبلاگ بنیاد اتریوم](https://blog.ethereum.org/2016/05/09/on-settlement-finality/) توضیح داده شده است. از آنجا که نهایی شدن نیاز به اکثریت دو سوم دارد، مهاجم می‌تواند از طریق رأی دادن با یک‌سوم کل سهام، از نهایی شدن شبکه جلوگیری کند. ساز و کاری برای دفاع در برابر این موضوع وجود دارد: [نشت عدم فعالیت](https://eth2book.info/bellatrix/part2/incentives/inactivity). این ساز و کار هر زمان که زنجیره برای بیش از چهار ایپوک نتواند نهایی شود، فعال می‌شود. نشت عدم فعالیت، ETH مخاطره‌آمیز را از اعتبارسنج‌هایی که علیه اکثریت رأی می‌دهند، دور می‌کند و به اکثریت اجازه می‌دهد دو سوم اکثریت را دوباره به دست آورند و زنجیره را نهایی کنند.

## امنیت اقتصاد رمزارز {#crypto-economic-security}

اجرای اعتبارسنج یک تعهد است. انتظار می‌رود اعتبارسنج سخت‌افزار و اتصال کافی به اینترنت را برای مشارکت در اعتبارسنج بلوک و پیشنهاد حفظ کند. در ازای آن، به اعتبارسنج ETH پرداخت می‌شود (موجودی سهام‌گذاری‌شده آن افزایش می‌یابد). از سوی دیگر، شرکت به‌عنوان اعتبارسنج، راه‌های جدیدی را برای حمله‌ کاربران به شبکه با هدف حصول منافع شخصی یا خرابکاری باز می‌کند. برای جلوگیری از این امر، اعتبارسنج‌ها در صورت عدم موفقیت در مشارکت هنگام فراخوانی، ETHهای پاداش داده شده را از دست می‌دهند و در صورت رفتار غیرصادقانه، سهام موجود آنها از بین می‌رود. دو رفتار اصلی که می‌توان آنها را غیرصادقانه در نظر گرفت: پیشنهاد چند بلوک در یک اسلات (مبهم‌سازی) و ارائه تصدیق‌های متناقض.

مقدار ETH که کم می‌شود به این بستگی دارد که چند اعتبارسنج در آن واحد جریمه می شوند. این را [«جریمه‌ همبستگی»](https://eth2book.info/bellatrix/part2/incentives/slashing#the-correlation-penalty) می‌نامند، و می‌تواند جزئی باشد (حدود 1% سهام برای یک اعتبارسنج منفرد که مشمول برخورد شدید شود) یا می‌تواند منجر به از بین رفتن 100% سهام اعتباردهنده شود (جریمه شدید انبوه). برخورد شدید در نیمه‌ راه یک دوره‌ خروج اجباری اعمال می‌شود که با جریمه‌ فوری (تا 1 اتر) در روز 1، با جریمه‌ همبستگی در روز 18 ادامه می‌یابد، و در نهایت، با بیرون رانده شدن از شبکه در روز 36 آغاز می‌شود. آن‌ها هر روز جریمه‌های جزئی تصدیق دریافت می‌کنند زیرا در شبکه حضور دارند اما رأی نمی‌دهند. همه‌ی این‌ها به این معنی است که یک حمله‌ هماهنگ برای مهاجم بسیار پرهزینه خواهد بود.

## انتخاب فورک {#fork-choice}

هنگامی که شبکه به‌طور بهینه و صادقانه عمل می‌کند، تنها یک بلوک جدید در رأس زنجیره وجود دارد و همه اعتبارسنج‌ها آن را تصدیق می‌کنند. با این حال، این امکان وجود دارد که اعتبارسنج‌ها به دلیل تأخیر شبکه یا مبهم بودن پیشنهاددهنده‌ بلوک، دیدگاه‌های متفاوتی نسبت به سر زنجیره داشته باشند. بنابراین، کاربرهای اجماع به یک الگوریتم نیاز دارند تا تصمیم بگیرند کدام‌ یک را ترجیح دهند. الگوریتم مورد استفاده در اثبات سهام اتریوم [LMD-GHOST](https://arxiv.org/pdf/2003.03052.pdf) نام دارد و با شناسایی فورکی که دارای سنگین‌ وزن‌ترین تصدیق در تاریخچه‌ آن است کار می‌کند.

## اثبات سهام و امنیت {#pos-and-security}

خطر حمله [51%](https://www.investopedia.com/terms/1/51-attack.asp) همچنان در مورد اثبات سهام وجود دارد، همان‌طور که در اثبات کار وجود دارد، اما برای مهاجمان حتی از این هم خطرناک‌تر است. یک مهاجم به 51% از ETH سهام‌گذاری‌شده نیاز دارد. سپس می‌توانستند از تصدیق‌های خود استفاده کنند تا اطمینان حاصل کنند که فورک ترجیحی آنها دارای بیشترین تعداد تصدیق‌ است. «وزن» تصدیق‌های انباشته‌شده همان چیزی است که کاربرهای اجماع برای تعیین زنجیره‌ صحیح استفاده می‌کنند، بنابراین این مهاجم می‌تواند فورک خود را به فورک متعارف تبدیل کند. با این حال، نقطه‌ قوت اثبات سهام نسبت به اثبات کار این است که جامعه‌ کاربران آن از امکان تدارک ضدحمله برخوردار است. برای مثال، اعتبارسنج‌های صادق می‌توانند تصمیم بگیرند که به ساختن زنجیره‌ اقلیت ادامه دهند و فورک مهاجم را نادیده بگیرند و در عین حال برنامه‌ها، صرافی‌ها و استخرها را به انجام همین کار تشویق کنند. آن‌ها همچنین می‌توانند تصمیم بگیرند که مهاجم را به‌ زور از شبکه حذف کنند و ETH سهام‌گذاری‌ شده‌ آن را نابود کنند. این‌ها دفاع‌های اقتصادی قوی‌ در برابر حمله‌ 51% هستند.

علاوه بر حملات 51 درصدی، طرف‌های بد ممکن است انواع دیگری از فعالیت‌های مخرب را نیز انجام دهند، مانند:

- حملات دوربرد (اگرچه ابزار قطعیت، این بردار حمله را خنثی می‌کند)
- "reorgs" کوتاه برد (اگرچه مهلت‌های تقویت پیشنهاددهنده و تصدیق این موضوع را کاهش می‌دهند)
- حملات برگشتی و متعادل کننده (همچنین با تقویت پیشنهاددهنده کاهش می‌یابد و این حملات به هر حال فقط در شرایط شبکه ایده آل نشان داده شده‌اند)
- حملات بهمن (خنثی‌شده توسط قانون الگوریتم‌های انتخاب فورک با در نظر گرفتن آخرین پیام)

به‌طور کلی، اثبات سهام، به شکلی که در اتریوم پیاده‌سازی می‌شود، از نظر اقتصادی امن‌تر از اثبات کار است.

## مزایا و معایب {#pros-and-cons}

| نقاط مثبت                                                                                                                                                                                                                         | نقاط منفی                                                                        |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| سهام‌گذاریْ مشارکت افراد در تأمین امنیت شبکه و افزایش تمرکززدایی را آسان‌تر می‌کند. گره‌ی اعتبارسنج را می‌توان روی یک لپ‌تاپ معمولی اجرا کرد. استخرهای سهام‌گذاری به کاربران امکان می‌دهند بدون داشتن 32 اتریوم، سهام‌گذاری کنند. | اثبات سهام در مقایسه با اثبات کار، جوان‌تر است و کمتر مورد آزمایش قرار گرفته است |
| سهام‌گذاری غیرمتمرکزتر است. مزیت مقیاس به شکلی که برای استخراج PoW اعمال می‌شد، اعمال نمی‌شود.                                                                                                                                    | اجرای اثبات سهام پیچیده‌تر از اثبات کار است                                      |
| اثبات سهام در مقایسه با اثبات کار، امنیت بیشتری از حیث اقتصاد رمزارز ارائه می‌دهد                                                                                                                                                 | کاربران برای مشارکت در اثبات سهام اتریوم باید سه نرم‌افزار را اجرا کنند.         |
| برای ایجاد انگیزه در شرکت‌کنندگان شبکه، کمتر لازم است ETH جدید صادر شود                                                                                                                                                           |                                                                                  |

### مقایسه با اثبات کار {#comparison-to-proof-of-work}

اتریوم در ابتدا از اثبات کار استفاده می‌کرد اما در سپتامبر 2022 به اثبات سهام روی آورد. اثبات سهام چندین مزیت نسبت به اثبات کار دارد، مانند:

- بازده انرژی بهتر - هیچ نیازی به استفاده از انرژی بسیار زیاد محاسبات اثبات کار نیست
- موانع کمتر برای ورود، سخت‌افزار موردنیاز کمتر – برای برخورداری از شانس ساختن بلوک‌های جدید، نیازی به سخت‌افزار عجیب و خاص نیست
- کاهش ریسک تمرکز - اثبات سهام باید به تعداد گره‌های بیشتری در حال برقراری امنیت شبکه بیانجامد
- به دلیل نیاز به انرژی کمتر، تولید اتر کمتری برای تشویق شرکت‌کننده‌ها نیاز است
- جریمه‌های اقتصادی برای رفتار اشتباه باعث می شود که حملات مدل 51% برای حمله‌کننده به نسبت اثبات کار پرهزینه شوند
- در صورتی که حمله‌ی 51% در شرف فائق آمدن بر دفاع‌های رمزارزی-اقتصادی بود، جامعه می‌تواند به بازیابی اجتماعی یک زنجیره‌ی صادق متوسل شود.

## بیشتر بخوانید {#further-reading}

- [سؤالات متداول درباره‌ اثبات سهام](https://vitalik.eth.limo/general/2017/12/31/pos_faq.html) _ویتالیک بوترین_
- [اثبات سهام چیست؟](https://consensys.net/blog/blockchain-explained/what-is-proof-of-stake/) _ConsenSys_
- [اثبات سهام چیست و چرا اهمیت دارد](https://bitcoinmagazine.com/culture/what-proof-of-stake-is-and-why-it-matters-1377531463) _ویتالیک بوترین_
- [چرا اثبات سهام (نوامبر 2020)](https://vitalik.eth.limo/general/2020/11/06/pos2020.html) _ویتالیک بوترین_
- [اثبات سهام: چگونه یاد گرفتم که سویه‌گیری خفیف را دوست داشته باشم](https://blog.ethereum.org/2014/11/25/proof-stake-learned-love-weak-subjectivity/) _ ویتالیک بوترین_
- [حمله و دفاع اثبات سهام اتریوم](https://mirror.xyz/jmcook.eth/YqHargbVWVNRQqQpVpzrqEQ8IqwNUJDIpwRP7SS5FXs)
- [فلسفه‌ طراحی اثبات سهام](https://medium.com/@VitalikButerin/a-proof-of-stake-design-philosophy-506585978d51) _ویتالیک بوترین_
- [ویدیو: ویتالیک بوترین اثبات سهام را برای لکس فریدمن توضیح می دهد](https://www.youtube.com/watch?v=3yrqBG-7EVE)

## موضوعات مرتبط {#related-topics}

- [اثبات کار](/developers/docs/consensus-mechanisms/pow/)
- [اثبات صلاحیت (PoA)](/developers/docs/consensus-mechanisms/poa/)
