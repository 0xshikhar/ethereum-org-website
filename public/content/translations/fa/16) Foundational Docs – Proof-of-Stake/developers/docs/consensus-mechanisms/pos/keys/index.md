---
title: کلید ها در اثبات-سهم اتریوم
description: توضیحی درباره کلیدهای استفاده شده در مکانیسم اجماع اثبات سهام اتریوم
lang: fa
---

اتریوم از دارایی‌های کاربران با استفاده از رمزنگاری کلید عمومی-خصوصی محافظت می‌کند. کلید عمومی به عنوان پایه برای یک آدرس اتریوم استفاده می‌شود - یعنی برای عموم قابل مشاهده است و به عنوان یک شناسه منحصر به فرد استفاده می‌شود. کلید خصوصی (یا 'سرّی') باید تنها در دسترس مالک حساب باشد. کلید خصوصی برای "امضای" تراکنش‌ها و داده‌ها استفاده می‌شود تا رمزنگاری بتواند ثابت کند که دارنده برخی اقدامات یک کلید خصوصی خاص را تایید می‌کند.

کلیدهای اتریوم با استفاده از [رمزنگاری منحنی بیضی](https://en.wikipedia.org/wiki/Elliptic-curve_cryptography) تولید می‌شوند.

با این حال، زمانی که اتریوم از [اثبات کار](/developers/docs/consensus-mechanisms/pow) به [اثبات سهام](/developers/docs/consensus-mechanisms/pos) تغییر کرد، نوع جدیدی از کلید به اتریوم اضافه شد. کلیدهای اصلی دقیقاً مانند قبل کار می‌کنند - هیچ تغییری در کلیدهای مبتنی بر منحنی بیضوی که حساب‌ها را ایمن می‌کنند ایجاد نشده است. با این حال، کاربران به نوع جدیدی از کلید برای شرکت در اثبات سهام با سهام گذاری اتریوم و اجرای اعتبارسنج ها نیاز داشتند. این نیاز از چالش‌های مقیاس‌پذیری مرتبط با تعداد زیادی پیام بین تعداد زیادی اعتبارسنج ایجاد شد که به یک روش رمزنگاری نیاز داشت که بتواند به راحتی برای کاهش مقدار ارتباط مورد نیاز برای رسیدن شبکه به اجماع جمع شود.

این نوع جدید کلید از طرح امضای [**Boneh-Lynn-Sacham (BLS)**](https://wikipedia.org/wiki/BLS_digital_signature) استفاده می کند. BLS امکان جمع‌بندی بسیار کارآمد امضاها را فراهم می‌کند اما همچنین مهندسی معکوس کلیدهای اعتبارسنج فردی جمع‌شده را امکان‌پذیر می‌کند و برای مدیریت اقدامات بین اعتبارسنج ها ایده‌آل است.

## دو نوع کلید اعتبارسنج {#two-types-of-keys}

قبل از تغییر به اثبات سهام، کاربران اتریوم فقط یک کلید خصوصی مبتنی بر منحنی بیضوی برای دسترسی به وجوه خود داشتند. با معرفی اثبات سهام، کاربرانی که می‌خواستند سهامداران انفرادی باشند نیز به یک **کلید اعتبارسنج** و یک **کلید برداشت** نیاز داشتند.

### کلید اعتبارسنج {#validator-key}

کلید امضای اعتبارسنج از دو بخش تشکیل شده است:

- کلید **خصوصی** اعتبارسنج
- کلید **عمومی** اعتبارسنج

هدف کلید خصوصی اعتبارسنج امضای عملیات روی زنجیره مانند پیشنهاد بلوک و تصدیق‌ها است. به همین دلیل، این کلیدها باید در یک کیف پول داغ نگهداری شوند.

این انعطاف‌پذیری این مزیت را دارد که کلیدهای امضای اعتبارسنج را خیلی سریع از یک دستگاه به دستگاه دیگر منتقل می‌کند، با این حال، اگر آنها گم یا دزدیده شده باشند، دزد ممکن است به چند روش **به صورت مخرب** عمل کند:

- اعتبارسنج را با موارد زیر جریمه کنید:
  - یک پیشنهاد دهنده بودن و امضای دو بلوک بیکن متفاوت برای یک اسلات یکسان
  - یک گواهی‌دهنده بودن و امضای گواهی‌ که گواهی دیگری را "احاطه" می‌کند
  - یک گواهی‌دهنده بودن و امضای دو گواهی متفاوت با هدف یکسان
- خروج داوطلبانه را تحمیل کنید که اعتبارسنج را از سهام گذاری کردن متوقف می کند و دسترسی به موجودی ETH آن را به مالک کلید برداشت اعطا می کند

**کلید عمومی اعتبارسنج** زمانی در داده‌های تراکنش گنجانده می‌شود که کاربر ETH را در قرارداد سهام گذاری سپرده گذاری کند. این به _داده های سپرده_ معروف است و به اتریوم اجازه می دهد اعتبارسنج را شناسایی کند.

### اعتبارنامه‌های برداشت {#withdrawal-credentials}

هر اعتبارسنج دارای خاصیتی است که به نام _اعتبارنامه‌های برداشت_ شناخته می‌شود. این فیلد 32 بایتی با یک `0x00` شروع می‌شود که نمایانگر اعتبارنامه‌های خروج BLS است، یا با یک `0x01`، که نشان‌دهنده اعتبارنامه‌هایی است که به یک آدرس اجرا اشاره می‌کنند.

اعتبارسنجها با کلیدهای `0x00` BLS باید این اعتبارنامه ها را به‌روزرسانی کنند تا به یک آدرس اجرا اشاره کنند تا بتوانند پرداخت‌های مازاد مانده یا برداشت کامل از سهام گذاری را فعال کنند. این کار را می‌توان با ارائه یک آدرس اجرا در داده های سپرده در طول تولید کلید اولیه، _OR_ با استفاده از کلید برداشت در زمان دیگری برای امضا و پخش پیام `BLSToExecutionChange` انجام داد.

### کلید برداشت از حساب {#withdrawal-key}

کلید برداشت از حساب برای به‌روزرسانی اعتبارنامه های برداشت برای اشاره به یک آدرس اجرا، در صورتی که در هنگام سپرده اولیه تنظیم نشده باشد، مورد نیاز خواهد بود. این امکان را فراهم می‌کند که پرداخت‌های مانده شروع به پردازش شوند و همچنین به کاربران اجازه می‌دهد تا کل اتریوم سهام گذاری شده خود را برداشت کنند.

درست مانند کلیدهای اعتبارسنجی، کلیدهای برداشت نیز از دو جزء تشکیل شده است:

- کلید **خصوصی** برداشت
- کلید **عمومی** برداشت

از دست دادن این کلید قبل از به‌روزرسانی اعتبارنامه های برداشت به نوع `0x01` به معنای از دست دادن دسترسی به موجودی اعتبارسنج است. اعتبارسنج هنوز می‌تواند گواهی‌ها و بلوک‌ها را امضا کند زیرا این اقدامات به کلید خصوصی اعتبارسنج نیاز دارند، اما اگر کلیدهای برداشت از بین بروند، انگیزه کمی وجود دارد یا اصلاً وجود ندارد.

جداسازی کلیدهای اعتبارسنج از کلیدهای حساب اتریوم امکان اجرای چندین اعتبارسنج توسط یک کاربر را فراهم می‌کند.

![شماتیک کلید اعتبارسنج](validator-key-schematic.png)

## استخراج کلیدها از عبارت بذر {#deriving-keys-from-seed}

اگر هر ۳۲ اتریوم سهام گذاری شده به یک مجموعه جدید از ۲ کلید کاملا مستقل نیاز داشت، مدیریت کلید به سرعت غیرقابل کنترل می‌شد، به ویژه برای کاربرانی که چندین اعتبارسنج را اجرا می‌کنند. در عوض، چندین کلید اعتبارسنج می‌توانند از یک کلید خصوصی مشترک استخراج شوند و ذخیره کردن آن کلید خصوصی واحد امکان دسترسی به چندین کلید اعتبارسنج را فراهم می‌کند.

[عبارت‌های بازیابی](https://en.bitcoinwiki.org/wiki/Mnemonic_phrase) و مسیرها ویژگی های برجسته ای هستند که کاربران اغلب هنگام [دسترسی به](https://ethereum.stackexchange.com/questions/19055/what-is-the-difference-between-m-44-60-0-0-and-m-44-60-0) کیف پول خود با آنها مواجه می شوند. عبارات بازیابی یک دنباله از کلمات است که به عنوان بذر اولیه برای یک کلید خصوصی عمل می‌کند. هنگامی که با داده‌های اضافی ترکیب شود، عبارت بازیابی یک هش به نام "کلید اصلی" تولید می‌کند. این را می توان به عنوان ریشه یک درخت در نظر گرفت. سپس می توان شاخه هایی از این ریشه را با استفاده از یک مسیر سلسله مراتبی استخراج کرد تا گره های فرزند بتوانند به عنوان ترکیبی از هش گره والد خود و شاخص آنها در درخت وجود داشته باشند. درباره استانداردهای [BIP-32](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki) و [BIP-19](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki) برای تولید کلید مبتنی بر عبارت بازیابی مطالعه کنید.

این مسیرها ساختار زیر را دارند که برای کاربرانی که با کیف پول‌های سخت‌افزاری تعامل داشته‌اند آشنا خواهد بود:

```
m/44'/60'/0'/0`
```

جریمه ها در این مسیر، اجزای کلید خصوصی را به شرح زیر جدا می‌کنند:

```
master_key / purpose / coin_type / account / change / address_index
```

این منطق به کاربران اجازه می‌دهد تا بیشترین تعداد ممکن اعتبارسنج را به یک **عبارت بازیابی** متصل کنند، زیرا ریشه درخت می‌تواند مشترک باشد و تمایز در شاخه‌ها اتفاق می‌افتد. کاربر می تواند **هر تعداد کلید** را از عبارات بازیابی استخراج کند.

```
      [m / 0]
     /
    /
[m] - [m / 1]
    \
     \
      [m / 2]
```

هر شاخه با یک `/` از هم جدا می شود، بنابراین `m/2` به معنای شروع با کلید اصلی و دنبال کردن شاخه 2 است. در طرح زیر از یک عبارت بازیابی واحد برای ذخیره سه کلید برداشت استفاده می‌شود که هر کدام دارای دو اعتبارسنج مرتبط هستند.

![منطق کلید اعتبارسنج](multiple-keys.png)

## بیشتر بخوانید {#further-reading}

- [پست وبلاگ بنیاد اتریوم توسط Carl Beekhuizen](https://blog.ethereum.org/2020/05/21/keys/)
- [تولید کلید BLS12-381 بر اساس EIP-2333](https://eips.ethereum.org/EIPS/eip-2333)
