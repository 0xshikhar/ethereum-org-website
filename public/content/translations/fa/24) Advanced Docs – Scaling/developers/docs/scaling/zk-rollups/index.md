---
title: رول‌آپ‌های دانش-صفر
description: مقدمه ای بر رول‌آپ های دانش-صفر، یک راه حل مقیاس پذیری که توسط جامعه اتریوم استفاده می‌شود.
lang: fa
---

رول‌آپ های دانش-صفر (ZK-rollups)، [راه‌حل‌های مقیاس‌پذیری](/developers/docs/scaling/) لایه دوم هستند که با جابجایی محاسبات و حالت ذخیره‌سازی به خارج از زنجیره اتریوم، توان عملیاتی را در شبکه اصلی اتریوم افزایش می‌دهند. رول‌آپ های دانش-صفر می‌توانند هزاران تراکنش را به صورت دسته‌ای پردازش کنند و سپس تنها خلاصه‌ای فشرده از داده‌ها را به شبکه اصلی اتریوم ارسال کنند. این خلاصه‌ی فشرده داده‌ها، تغییراتی را که باید در حالت اتریوم شکل بگیرد و چند اثبات رمزنگاری که درست بودن آن تغییرات را ثابت می‌کند، تعریف می‌کند.

## موارد مورد نیاز {#prerequisites}

شما باید صفحه ما را در [مقیاس‌سازی اتریوم](/developers/docs/scaling/) و [لایه 2](/layer-2) خوانده و درک کرده باشید.

## رول‌آپ دانش-صفر چیست؟ {#what-are-zk-rollups}

**رول‌آپ های دانش-صفر (ZK-rollups)**، دسته های تراکنش‌هایی (یا همان رول‌آپ‌هایی) را که خارج از زنجیره اجرا می‌شوند را یک دسته می‌کنند. محاسبات خارج از زنجیره، مقدار داده‌ای که باید به بلاک چین ارسال شود را کاهش می‌دهد. اپراتورهای رول‌آپ های دانش-صفر، خلاصه‌ای را از تغییرات مورد نیاز برای نمایش تمام تراکنش‌ها در یک دسته را به جای ارسال هر تراکنش به صورت جداگانه، می‌فرستند. آنها همچنین [اثبات اعتبار](/glossary/#validity-proof) را برای اثبات درستی تغییرات خود تولید می کنند.

حالت رول‌آپ دانش-صفر توسط یک قرارداد هوشمند مستقر در شبکه اتریوم ذخیره و مدیریت می شود. برای به‌روزرسانی این حالت، گره‌های رول‌آپ دانش-صفر باید یک اثبات ادعا را برای تأیید ارسال کنند. همانطور که ذکر شد، اثبات ادعا یک تضمین رمزنگاری می‌باشد که اطمینان می‌دهد تغییر حالت پیشنهادی توسط رول‌‌آپ واقعاً نتیجه اجرای همان دسته‌ از تراکنش‌های مربوطه است. این بدان معناست که رول‌آپ های دانش-صفر به جای پست کردن تمام داده‌های تراکنش در زنجیره مانند [رول‌‌آپ های خوش‌بینانه](/developers/docs/scaling/optimistic-rollups/)، تنها به ارائه اثبات ادعا برای نهایی کردن تراکنش‌ها در اتریوم نیاز دارند.

هیچ تاخیری در انتقال وجوه از رول‌آپ دانش-صفر به اتریوم وجود ندارد، زیرا تراکنش های خروج پس از تائید اعتبار اثبات ادعا توسط قرارداد رول‌آپ دانش-صفر، انجام می شوند. اما در عوض، برداشت وجوه از رول‌آپ های خوش‌بینانه با تأخیر احتمالی همراه است تا هر کسی بتواند تراکنش خروج را با [اثبات تقلب](/glossary/#fraud-proof) به چالش بکشد.

رول‌آپ های دانش-صفر تراکنش ها را در قالب `calldata` به اتریوم می نویسند. `calldata` محلی است که داده‌هایی که با فراخوان‌های خارجی به توابع قرارداد هوشمند همراه هستند، ذخیره می‌شوند. اطلاعات موجود در `calldata` در بلاک‌چین منتشر می‌شود و به هر کسی اجازه می‌دهد تا حالت رول‌‌آپ را به‌طور مستقل بازسازی کند. رول‌آپ های دانش-صفر از تکنیک‌های فشرده‌سازی برای کاهش داده‌های تراکنش استفاده می‌کنند - برای مثال، حساب‌ها به جای یک آدرس، با یک ایندکس نشان داده می‌شوند که مصرف ۲۸ بایت داده را کاهش می‌دهد. انتشار داده‌ها برو روی شبکه اصلی، هزینه قابل توجهی را برای رول‌‌آپ‌ها دارد بنابراین فشرده‌سازی داده‌ها می‌تواند هزینه‌ها را برای کاربران کاهش دهد.

## رول‌آپ های دانش-صفر چگونه با اتریوم تعامل دارند؟ {#zk-rollups-and-ethereum}

زنجیره رول‌آپ دانش-صفر، یک پروتکل خارج از زنجیره است که در لایه بالایی بلاک‌چین اتریوم عمل می‌کند و توسط قراردادهای هوشمند اتریوم روی زنجیره اصلی اتریوم مدیریت می شود. رول‌آپ های دانش-صفر، تراکنش‌ها را خارج از شبکه اصلی اجرا می‌کنند، اما به‌طور دوره‌ای دسته‌های تراکنش‌های خارج از زنجیره را به یک قرارداد رول‌‌آپ مستقر در شبکه اصلی اتریوم متعهد می‌کنند. این ثبت تراکنش مانند بلاک‌چین اتریوم تغییر ناپذیر می‌باشد و زنجیره رول‌آپ دانش-صفر را تشکیل می دهد.

هسته اصلی رول‌آپ دانش-صفر از اجزای زیر تشکیل شده است:

1. **قراردادهای هوشمند مستقر در شبکه اتریوم**: همانطور که گفته شد، پروتکل رول‌آپ دانش-صفر توسط قراردادهای هوشمند در حال اجرا بر روی اتریوم کنترل می شود. این شامل قرارداد اصلی است که بلوک‌های رول‌‌آپ را ذخیره می‌کند، سپرده‌ها را ردیابی می‌کند و به‌روزرسانی‌های حالت را نظارت می‌کند. یکی دیگر از قراردادهای مستقر در شبکه اتریوم (قرارداد تأیید کننده) ادعاهای دانش صفر ارائه شده توسط تولیدکنندگان بلوک را تائید می کند. بنابراین، اتریوم به عنوان لایه پایه یا "لایه اول" برای رول‌آپ دانش-صفر عمل می کند.

2. **ماشین مجازی خارج از زنجیره (VM)**: گرچه که پروتکل رول‌آپ دانش-صفر در اتریوم در حال اجراست، اجرای تراکنش و ذخیره‌سازی حالت در یک ماشین مجازی جداگانه مستقل از [ EVM](/developers/docs/evm/) انجام می‌شود. این ماشین مجازی یا VM خارج از زنجیره، محیط اجرا برای تراکنش‌های رول‌آپ دانش-صفر است و به عنوان لایه ثانویه یا "لایه دوم" برای پروتکل رول‌آپ دانش-صفر عمل می‌کند. اثبات ادعاهایی که در شبکه اتریوم تائید شده‌اند، درست بودن انتقال حالت را در ماشین مجازی خارج از زنجیره تضمین می کند.

رول‌آپ های دانش-صفر "راه‌حل‌های مقیاس‌پذیری ترکیبی" هستند - پروتکل‌های خارج از زنجیره که به طور مستقل عمل می‌کنند اما امنیت را از اتریوم می‌گیرند. به خصوص شبکه اتریوم اعتبار به‌روزرسانی‌های حالت را در رول‌آپ دانش-صفر اعمال می‌کند و در دسترس بودن داده‌ها در حالت رول‌‌آپ را پس از هر به‌روزرسانی، تضمین می‌کند. در نتیجه، رول‌آپ های دانش-صفر به‌طور قابل‌توجهی امن‌تر از راه‌حل‌های مقیاس‌پذیری کاملاً خارج از زنجیره هستند، مانند [زنجیره‌های جانبی](/developers/docs/scaling/sidechains/)، که خودشان مسئول ویژگی‌های امنیتی خودشان هستند، یا [ولیدیوم‌ها](/developers/docs/scaling/validium/) که همچنین تأیید می‌کنند تراکنش‌های روی اتریوم با اثبات ادعاها انجام می‌شود، اما داده‌های تراکنش در جای دیگری ذخیره می‌شوند.

رول‌آپ های دانش-صفر برای موارد زیر به پروتکل اصلی اتریوم متکی هستند:

### دسترسی به داده‌ها {#data-availability}

رول‌آپ دانش-صفر، داده‌های حالت را برای هر تراکنش پردازش شده خارج از زنجیره به اتریوم منتشر می‌کنند. با این داده‌ها، افراد یا کسب‌وکارها می‌توانند حالت رول‌‌آپ را بازتولید نمایند و خودشان زنجیره را تائید کنند. اتریوم این داده ها را در قالب `calldata` در اختیار همه استفاده کنندگان و شرکت کنندگان شبکه قرار می دهد.

رول‌آپ های دانش-صفر نیازی به انتشار داده‌های تراکنش زیادی روی زنجیره اصلی ندارند، زیرا اثبات‌های ادعا قبلاً صحت انتقال حالت را تأیید کرده اند. با این وجود، ذخیره داده‌ها در زنجیره اصلی اتریوم همچنان مهم است زیرا امکان تائید بدون اجازه و مستقل وضعیت زنجیره لایه دوم را می‌دهد که به نوبه خود به هر کسی اجازه می‌دهد دسته‌ای از تراکنش‌ها را ارسال کند و از سانسور یا مسدود کردن زنجیره توسط اپراتورهای بد اندیش جلوگیری می‌کند.

تعامل کاربران بر روی شبکه اصلی با رول‌‌آپ الزامی است. کاربران بدون دسترسی به داده‌های ایالتی نمی‌توانند موجودی حساب خود را درخواست کنند یا تراکنش‌هایی (مانند برداشت‌ها) را که به اطلاعات حالت متکی هستند، آغاز کنند.

### نهائی شدن تراکنش {#transaction-finality}

اتریوم به عنوان یک لایه توافق برای رول‌آپ های دانش-صفر عمل می کند: تراکنش های لایه 2 تنها در صورتی نهایی می شوند که قرارداد لایه 2، اثبات ادعا را بپذیرد. این کار خطر دستکاری کردن زنجیره توسط اپراتورهای مخرب (به عنوان مثال، سرقت وجوه موجود در رول‌‌آپ) را از بین می‌برد زیرا هر تراکنش باید در شبکه اصلی اتریوم تائید شود. همچنین، اتریوم تضمین می‌کند که پس از نهائی شدن در لایه اصلی، عملیات انجام شده توسط کاربر، نمی‌تواند معکوس شود.

### مقاومت در برابر سانسور {#censorship-resistance}

اکثر رول‌آپ های دانش-صفر از یک "ابر گره" (اپراتور) برای اجرای تراکنش ها، تولید دسته ها و ارسال بلوک‌ها به لایه اصلی اتریوم استفاده می‌کنند. در حالی که این امر کارائی را تضمین می‌کند، اما خطر سانسور را افزایش می‌دهد: اپراتورهای مخرب رول‌آپ دانش-صفر می‌توانند با امتناع از گنجاندن تراکنش‌های کاربران در دسته تراکنش‌ها، آن‌ها را سانسور کنند.

به عنوان یک ملاحظه امنیتی، رول‌آپ دانش-صفر به کاربران این امکان را می‌دهد که اگر فکر می‌کنند تراکنش‌ها توسط اپراتور سانسور می‌شوند، خودشان مستقیماً آن را به قرارداد رول‌‌آپ در شبکه اتریوم ارسال نمایند. این به کاربران اجازه می‌دهد بدون اتکا به اجازه اپراتور، از رول‌آپ دانش-صفر به اتریوم خارج شوند.

## طرز کار رول‌آپ دانش-صفر چگونه است؟ {#how-do-zk-rollups-work}

### تراکنش‌ها {#transactions}

کاربران در رول‌آپ دانش-صفر تراکنش ها را امضا می کنند و برای پردازش و گنجاندن در دسته ارسالی بعدی به اپراتورهای لایه دوم می‌فرستند. در برخی موارد، اپراتور یک نهاد متمرکز به نام ترتیب‌دهنده است که تراکنش‌ها را اجرا می‌کند، آن‌ها را در دسته تراکنش‌ها گردآوری می‌کند و به لایه اصلی ارسال می‌کند. ترتیب‌دهنده در این سیستم تنها نهادی است که مجاز به تولید بلوک‌های لایه دوم و افزودن تراکنش‌های رول‌‌آپ به قرارداد هوشمند رول‌آپ دانش-صفر است.

سایر رول‌آپ های دانش-صفر ممکن است نقش اپراتور را با استفاده از مجموعه اطلاعات اعتبارسنجی [اثبات سهام](/developers/docs/consensus-mechanisms/pos/) با یکدیگر تعویض کنند. اپراتورهای احتمالی وجوهی را به قرارداد رول‌‌آپ واریز می‌کنند که اندازه هر سهم در شانس انتخاب شدن سهامداران برای تولید دسته بعدی تأثیر می‌گذارد. اگر اپراتور بدخواهانه عمل کند، می‌توان سهام اپراتور را بعنوان جریمه، قاچ کرد یا اصطلاحاً slashing کرد، که این امر آنها را تشویق می‌کند تا بلوک‌های معتبر را ارسال کنند.

#### نحوه انتشار داده‌های تراکنش در اتریوم توسط رول‌آپ های دانش-صفر {#how-zk-rollups-publish-transaction-data-on-ethereum}

همانطور که توضیح داده شد، داده‌های تراکنش در اتریوم به شکل `calldata` منتشر می شوند. `calldata` محلی در یک قرارداد هوشمند است که برای ارسال پارامترهای ورودی به یک تابع استفاده می‌شود و رفتاری مشابه با [حافظه مموری](/developers/docs/smart-contracts/anatomy/#memory) دارد. در حالی که `calldata` به‌عنوان بخشی از حالت اتریوم ذخیره نمی‌شود، در زنجیره اتریوم به عنوان بخشی از [گزارش‌های تاریخچه](https://docs.soliditylang.org/en/latest/introduction-to-smart-contracts.html?highlight=memory#logs) زنجیره اتریوم باقی خواهد ماند. `calldata` بر حالت اتریوم تأثیری نمی‌گذارد و آن را به راهی ارزان برای ذخیره داده‌ها در شبکه اتریوم تبدیل می‌کند.

کلمه کلیدی `calldata` معمولاً تابعی از قرارداد هوشمند را که توسط یک تراکنش فراخوانی می‌شود، شناسایی می‌کند و ورودی‌های تابع را در قالب یک دنباله دلخواه از بایت‌ها نگه می‌دارد و به آن وارد می‌کند. رول‌آپ دانش-صفر از `calldata` برای انتشار داده‌های فشرده تراکنش، در زنجیره استفاده می‌کنند. اپراتور رول‌‌آپ به سادگی با فراخوانی تابع مورد نیاز در قرارداد رول‌‌آپ یک دسته جدید اضافه می‌کند و داده‌های فشرده شده را به عنوان پارامترهای ورودی تابع ارسال می‌کند. این به کاهش هزینه‌ها برای کاربران کمک می‌کند، زیرا بخش بزرگی از هزینه‌های رول‌‌آپ صرف ذخیره داده‌های تراکنش در شبکه اتریوم می‌شود.

### ثبت تعهد حالت {#state-commitments}

حالت رول‌آپ دانش-صفر که شامل حساب‌ها و موجودی‌های لایه دوم می‌شود، در قالب [درخت مرکل](/whitepaper/#merkle-trees) نمایش داده می‌شود. یک هش رمزنگاری از ریشه درخت مرکل (ریشه مرکل) در قرارداد مستقر در زنجیره اتریوم ذخیره می‌شود و به پروتکل رول‌‌آپ اجازه می‌دهد تا تغییرات در حالت رول‌آپ دانش-صفر را ردیابی کند.

پس از اجرای مجموعه‌ای از تراکنش‌های جدید، رول‌‌آپ به حالت جدید تغییر خواهد کرد. اپراتوری که تغییر حالت را آغاز کرده است باید یک ریشه حالت جدید را محاسبه کرده و به قرارداد مستقر در زنجیره اتریوم ارسال کند. اگر اثبات ادعا مرتبط با دسته توسط قرارداد تأیید کننده، تأیید شود، ریشه مرکل جدید به ریشه کانونی حالت رول‌آپ دانش-صفر تبدیل می شود.

علاوه بر محاسبه ریشه های حالت، اپراتور رول‌آپ دانش-صفر همچنین یک ریشه دسته ایجاد می کند - یک ریشه مرکل که شامل تمام تراکنش‌های داخل یک دسته است. وقتی که یک دسته جدید ارسال می شود، قرارداد رول‌‌آپ ریشه دسته را ذخیره می کند و به کاربران امکان می دهد ثابت کنند که یک تراکنش (به عنوان مثال، درخواست برداشت) در دسته گنجانده شده است. کاربران باید جزئیات تراکنش، ریشه‌ی دسته و یک [اثبات مرکل](/developers/tutorials/merkle-proofs-for-offline-data-integrity/) را ارائه کنند که مسیر محلی که در آنجا شامل شده‌اند را نشان می دهد.

### اثبات‌های ادعا {#validity-proofs}

ریشه حالت جدیدی که اپراتور رول‌آپ دانش-صفر به قرارداد زنجیره اصلی اتریوم ارائه می‌کند، نتیجه به‌روز شدن حالت رول‌‌آپ است. فرض کنید آلیس 10 توکن برای باب می فرستد، اپراتور به سادگی موجودی آلیس را به مقدار 10 واحد کاهش می دهد و موجودی باب را به مقدار 10 واحد افزایش می دهد. اپراتور سپس داده‌های حساب به‌روز شده را هش می‌کند، درخت مرکل مجموعه را بازسازی می‌کند و ریشه مرکل جدید را به قرارداد روی زنجیره ارسال می‌کند.

اما تا زمانی که اپراتور ثابت نکند که ریشه مرکل جدید از به‌روزرسانی‌های صحیح حالت رول‌‌آپ منشأ گرفته است، قرارداد رول‌‌آپ به‌طور خودکار تعهد حالت پیشنهادی را نخواهد پذیرفت. اپراتور رول‌آپ دانش-صفر، این کار را با ارائه یک اثبات یا گواهی ادعا، که یک تعهد رمزنگاری مختصر است که صحت تراکنش‌های دسته‌ای را تأیید می‌کند، انجام می‌دهد.

گواهی ادعا به طرفین اجازه می دهد تا صحت یک گزاره را بدون افشای خود گزاره اثبات کنند - از این رو، آنها را اثبات های دانش صفر نیز می‌نامند. رول‌آپ های دانش-صفر از گواهی ادعا برای تائید صحت انتقال حالت های رخ داده خارج از زنجیره، بدون نیاز به اجرای مجدد تراکنش‌ها در اتریوم استفاده می‌کنند. این گواهی‌ها می‌توانند در قالب [ZK-SNARK (اسنارک دانش-صفر)](https://arxiv.org/abs/2202.06877) (معادل حروف اول استدلال غیر تعاملی مختصر دانش صفر به انگلیسی) یا [استارک دانش-صفر یا ZK-STARK](https://eprint.iacr.org/2018/046) (معادل حروف ابتدای استدلال شفاف مقیاس‌پذیر دانش صفر به انگلیسی) باشند.

هم SNARKها و هم STARKها به اثبات یکپارچگی محاسبات خارج از زنجیره در رول‌آپ های دانش-صفر کمک می کنند، اگرچه که هر نوع گواهی، ویژگی های متمایزی با نوع دیگر گواهی دارد.

**اسنارک‌های دانش-صفر**

برای کارکرد پروتکل ZK-SNARK یا همان اسنارک‌های دانش-صفر، ایجاد یک رشته مرجع مشترک (CRS) ضروری است: CRS پارامترهای عمومی را برای اثبات و تأیید گواهی ادعا ارائه می کند. امنیت سیستم اثبات بستگی به تنظیمات و ساختار CRS دارد. اگر اطلاعات مورد استفاده برای ایجاد پارامترهای عمومی در اختیار عوامل مخرب قرار گیرد، ممکن است بتوانند گواهی‌های ادعا نادرست تولید کنند.

برخی از رول‌آپ های دانش-صفر سعی می‌کنند این مشکل را با استفاده از [مراسم محاسباتی چند حزبی (MPC)](https://zkproof.org/2021/06/30/setup-ceremonies/amp/) که شامل افراد مورد اعتماد، برای تولید پارامترهای عمومی برای مدار ZK-SNARK می‌شود، حل کنند. هر یک از طرفین مقداری تصادفی (به نام "ضایعات سمی") در ساخت CRS مشارکت می دهند که باید فوراً آن را از بین ببرند.

به این دلیل از افراد مورد اعتماد و تنظیمات مطمئن استفاده می شود چون امنیت ساختار CRS را افزایش می دهند. تا زمانی که فقط یک دست اندرکار صادق و مورد اعتماد، ورودی خود را از بین ببرد، امنیت سیستم ZK-SNARK تضمین می شود. اما همچنان این رویکرد مستلزم اعتماد به دست اندرکاران برای حذف تصادفی نمونه آنها و عدم تضعیف تضمین‌های امنیتی سیستم است.

مفروضات اعتماد به کنار، اسنارک‌های دانش-صفر به دلیل اندازه‌های اثبات کوچک و تأیید در بازه زمانی ثابت بدون درنظر گرفتن اندازه ورودی‌ها، دارای محبوبیت زیادی هستند. از آنجایی که اثبات ادعا در زنجیره اصلی بیشتر هزینه‌ها را برای اجرای یک اسنارک‌های دانش-صفر تشکیل می دهد، لایه دو ها از اسنارک‌ها برای تولید اثبات‌هایی استفاده می کنند که می توانند به سرعت و ارزان در شبکه اصلی اتریوم تائید شوند.

**استارک‌های دانش-صفر**

همانند اسنارک‌ها (ZK-SNARKs)، استارک‌ها (ZK-STARKs) نیز معتبر بودن محاسبات خارج از زنجیره را بدون آشکار کردن ورودی ها ثابت می‌کنند. با این وجود، استارک‌های دانش-صفر به دلیل بهبود مقیاس پذیری و شفافیتی که ارائه می‌دهند، به عنوان پیشرفتی در اسنارک‌های دانش-صفر در نظر گرفته می‌شوند.

استارک‌های دانش-صفر، "شفاف" هستند، زیرا می‌توانند بدون تنظیمات قابل اعتماد یک رشته مرجع مشترک (CRS) کار کنند. در عوض، این استارک‌ها به ارقام تصادفی قابل تائید توسط عموم، جهت تنظیم پارامترهایی که برای تولید و تأیید ادعا هستند، متکی می‌باشند.

استارک‌های دانش-صفر همچنین مقیاس پذیری بیشتری را ارائه می دهند، زیرا زمان مورد نیاز برای محاسبات پشت پرده مربوط به تائید و اثبات گواهی‌های ادعا، به طور _شبه خطی_ افزایش می یابد. در اسنارک‌های دانش-صفر (ZK-SNARK‌ها)، زمان مورد نیاز برای محاسبات پشت پرده اثبات و راستی‌آزمایی گواهی ادعابه صورت _خطی_ افزایش می‌یابد. این بدان معناست که ZK-STARKها نسبت به ZK-SNARKها، به زمان کمتری برای اثبات و تائید مجموعه داده‌های بزرگ نیاز دارند، و آنها را به گزینه‌ی مناسبی برای برنامه‌های با حجم بالا تبدیل می‌کند.

همچنین استارک‌های دانش-صفر یا همان ZK-STARKها، در برابر رایانه‌های کوانتومی امن‌تر هستند، در حالی که اعتقاد بر این است که رمزنگاری منحنی بیضی (ECC) که در ZK-SNARKها استفاده می‌شود، مستعد حملات محاسباتی کوانتومی می‌باشد. نقطه ضعف ZK-STARKها این است که اندازه های اثبات بزرگ تری تولید می کنند که تأیید آن در اتریوم پرهزینه‌تر است.

#### گواهی‌های اثبات ادعا چگونه در رول‌آپ‌های دانش-صفر عمل می‌کنند؟ {#validity-proofs-in-zk-rollups}

##### ساخت گواهی

قبل از پذیرش تراکنش‌ها، اپراتور بررسی های معمول را انجام می دهد. این شامل تائید موارد زیر است:

- حساب‌های فرستنده و گیرنده بخشی از درخت مرکل حالت هستند.
- فرستنده دارای وجوه کافی برای پردازش تراکنش است.
- تراکنش صحیح است و با کلید عمومی فرستنده در رول‌‌آپ مطابقت دارد.
- Nonce (عدد یکبار مصرف تراکنش) فرستنده صحیح است و غیره.

به محض این که گره رول‌آپ دانش-صفر تراکنش‌های کافی داشته باشد، آنها را در یک دسته گردآوری می‌کند و ورودی ها را برای مدار اثبات کامپایل می‌کند تا در یک گواهی دانش-صفر مختصر کامپایل شود. این شامل:

- یک ریشه درخت مرکل که شامل تمام تراکنش‌های دسته است.
- اثبات‌های مرکل برای تراکنش‌ها، جهت اثبات مشمولیت آن‌ها در دسته تراکنش‌ها.
- گواهی‌های مرکل برای هر جفت فرستنده و گیرنده در تراکنش‌ها جهت اثبات این که حساب آن‌ها بخشی از درخت حالت رول‌‌آپ می‌باشد.
- مجموعه‌ای از ریشه‌های حالت میانی، که از به‌روزرسانی ریشه حالت پس از اعمال به‌روزرسانی‌های حالت برای هر تراکنش (یعنی کاهش موجودی حساب فرستنده و افزایش موجودی حساب گیرنده) به دست می‌آید.

مدار اثبات ادعا، گواهی اعتبار ادعا را با "اجرای متوالی" یا همان عمل looping بر روی هر تراکنش و انجام همان بررسی‌هایی که اپراتور، قبل از پردازش تراکنش آن‌ها انجام داده است، محاسبه می کند. ابتدا با استفاده از اثبات مرکل ارائه شده، تائید می‌کند که حساب فرستنده بخشی از ریشه حالت موجود است. سپس موجودی فرستنده را کاهش می‌دهد، nonce آن را افزایش می‌دهد، داده‌های به‌روز شده حساب را هش می‌کند و آن را با اثبات مرکل ترکیب می‌کند تا یک ریشه مرکل جدید ایجاد کند.

این ریشه مرکل تنها تغییرات در حالت رول‌آپ دانش-صفر را منعکس می‌کند: یعنی تغییر در موجودی فرستنده و nonce. این امر امکان‌پذیر می‌باشد چون که اثبات مرکلی که برای اثبات وجود حساب استفاده می شود، برای استخراج ریشه حالت جدید نیز استفاده می‌شود.

مدار اثبات ادعا همان فرآیند را بر حساب گیرنده انجام می‌دهد. مدار اثبات ادعا بررسی می‌کند که آیا حساب گیرنده تحت ریشه حالت میانی (با استفاده از گواهی اثبات مرکل) وجود دارد یا خیر، موجودی آنها را افزایش می‌دهد، داده‌های حساب را دوباره هش می‌کند و آن‌ها را با گواهی اثبات مرکل ترکیب می‌کند تا یک ریشه حالت جدید ایجاد نماید.

این پروسه برای هر تراکنش تکرار می‌شود. اجرای هر "حلقه" یا loop، یک ریشه حالت جدید از به‌روز رسانی حساب فرستنده و یک ریشه جدید متوالی از به‌روز رسانی حساب گیرنده ایجاد می‌کند. همان گونه که توضیح داده شد، هر به‌روز رسانی در ریشه حالت، نشان دهنده بخشی از تغییرات حالت درخت رول‌‌آپ است.

مدار اثبات ZK در کل دسته تراکنش تکرار می‌شود و دنباله به‌روزرسانی‌هایی را تأیید می‌کند که منجر به یک ریشه حالت نهایی پس از اجرای آخرین تراکنش می‌شود. آخرین ریشه مرکل محاسبه شده جدیدترین ریشه حالت متعارف ZK-rollup می شود.

##### تایید اثبات

پس از اینکه مدار اثبات صحت به‌روزرسانی‌های حالت را تأیید کرد، اپراتور L2 اثبات اعتبار محاسبه‌شده را به قرارداد تأییدکننده در L1 ارسال می‌کند. مدار تأیید قرارداد اعتبار اثبات را تأیید می کند و همچنین ورودی های عمومی را که بخشی از اثبات است بررسی می کند:

- **ریشه Pre-state**: ریشه حالت قدیمی ZK-rollup (یعنی قبل از اجرای تراکنش‌های دسته‌ای) که آخرین وضعیت معتبر شناخته شده زنجیره L2 را منعکس می‌کند.

- **ریشه پس از وضعیت**: ریشه وضعیت جدید ZK-rollup (یعنی پس از اجرای تراکنش‌های دسته‌ای) که منعکس‌کننده جدیدترین حالت زنجیره L2 است. ریشه post-state ریشه نهایی است که پس از اعمال به روز رسانی های حالت در مدار اثبات به دست می آید.

- **ریشه دسته ای**: ریشه مرکل دسته، که از تراکنش های _مرکلایزینگ_ در دسته و هش کردن ریشه درخت به دست می آید.

- **ورودی های تراکنش**: داده های مرتبط با تراکنش های انجام شده به عنوان بخشی از دسته ارسال شده.

اگر اثبات مدار را برآورده کند (یعنی معتبر است)، به این معنی است که دنباله‌ای از تراکنش‌های معتبر وجود دارد که جمع‌بندی را از حالت قبلی (از لحاظ رمزنگاری توسط ریشه پیش‌حالت اثرانگشت) به حالت جدید (از لحاظ رمزنگاری توسط ریشه پس از حالت اثرانگشت) انتقال می‌دهد. اگر ریشه pre-state با ریشه ذخیره شده در قرارداد رول‌‌آپ مطابقت داشته باشد و اثبات معتبر باشد، قرارداد رول‌‌آپ ریشه post-state را از اثبات می‌گیرد و درخت حالت آن را به‌روزرسانی می‌کند تا حالت تغییر یافته رول‌‌آپ را منعکس کند.

### ورودی ها و خروجی ها {#entries-and-exits}

کاربران با سپرده گذاری توکن ها در قرارداد رول‌‌آپ در زنجیره L1 وارد ZK-rollup می شوند. این تراکنش در صف قرار می گیرد زیرا فقط اپراتورها می توانند تراکنش ها را به قرارداد رول‌‌آپ ارسال کنند.

اگر صف سپرده معلق شروع به پر شدن کند، اپراتور ZK-rollup تراکنش های سپرده را می گیرد و آنها را به قرارداد رول‌‌آپ ارسال می کند. هنگامی که وجوه کاربر در رول آپ قرار گرفت، می تواند با ارسال تراکنش ها به اپراتور برای پردازش، تراکنش را آغاز کند. کاربران می‌توانند با هش کردن داده‌های حساب خود، ارسال هش به قرارداد رول‌‌آپ، و ارائه یک گواهی اثبات مرکل برای تأیید در برابر ریشه حالت فعلی، موجودی‌های رول‌‌آپ را تائید کنند.

برداشت کردن دارایی‌ها از رول‌آپ دانش-صفر به شبکه اصلی ساده است. کاربر تراکنش خروج را با ارسال دارایی‌های خود با رول‌‌آپ به یک حساب مشخص برای سوزاندن دارایی‌ها آغاز می‌کند. اگر اپراتور تراکنش را در دسته بعدی که می‌فرستد قرار دهد، کاربر می‌تواند درخواست برداشت را به قرارداد روی زنجیره اصلی ارسال کند. این درخواست برداشت شامل موارد زیر خواهد بود:

- اثبات مرکل اثبات می‌کند که تراکنش کاربر به حساب سوختن در یک دسته تراکنش وجود دارد

- داده‌های تراکنش

- ریشه دسته تراکنش‌ها

- آدرس شبکه اصلی یا L1 برای دریافت وجوه واریزی

قرارداد رول‌‌آپ داده‌های تراکنش را هش می‌کند، بررسی می‌کند که آیا ریشه دسته تراکنش‌ها وجود دارد یا خیر، و از اثبات مرکل برای بررسی اینکه آیا هش تراکنش بخشی از ریشه دسته تراکنش‌ها است، استفاده می‌کند. پس از آن، قرارداد، تراکنش خروج را اجرا می‌کند و وجوه را به آدرس انتخابی کاربر در L1 ارسال می‌کند.

## سازگاری رول‌آپ های دانش-صفر و EVM {#zk-rollups-and-evm-compatibility}

برخلاف رول‌آپ های خوش‌بینانه، رول‌آپ های دانش-صفر به راحتی با [ماشین مجازی اتریوم (EVM)](/developers/docs/evm/) سازگار نیستند. اثبات محاسبات همه منظوره EVM در مدارها از اثبات محاسبات ساده (مانند انتقال توکن که قبلاً توضیح داده شد) دشوارتر و با مصرف منابع بیش‌تر همراه است.

با این حال، [پیشرفت‌ها در فن‌آوری دانش-صفر](https://hackmd.io/@yezhang/S1_KMMbGt#Why-possible-now) در حال برانگیختن علاقه‌مندی مجدد به قرار دادن محاسبات EVM در اثبات‌های دانش-صفر است. این تلاش‌ها برای ایجاد یک پیاده‌سازی از EVM دانش-صفر (zkEVM) است که می‌تواند صحت اجرای برنامه را به‌طور مؤثر تائید کند. یک zkEVM کدهای EVM موجود را برای اثبات/تائید در مدارها بازسازی می‌کند و امکان اجرای قراردادهای هوشمند را فراهم می‌کند.

همانند EVM، یک zkEVM پس از محاسبه بر روی برخی از ورودی‌ها، بین حالت‌ها انتقال می‌یابد. تفاوت این است که zkEVM برای تأیید صحت هر مرحله از اجرای برنامه، گواهی اثبات دانش-صفر ایجاد می‌کند. اثبات گواهی اعتبار می‌تواند صحت عملیاتی را که حالت ماشین مجازی (حافظه، استک، ذخیره‌سازی) و خود محاسبات را لمس می‌کنند تائید کند (یعنی آیا عملیات کدهای عملیاتی مناسب را فراخوانی کرده و آنها را به درستی اجرا کرده است؟).

انتظار می‌رود که معرفی رول‌آپ های دانش-صفر سازگار با EVM به توسعه‌دهندگان کمک کند تا از مقیاس‌پذیری و تضمین‌های امنیتی گواهی‌های اثبات دانش-صفر استفاده کنند. مهم‌تر از آن، سازگاری با زیرساخت‌های بومی اتریوم به این معنی است که توسعه‌دهندگان می‌توانند با استفاده از ابزارها و زبان‌های آشنا (و آزمایش‌شده در برابر هک و باگ) dapp‌های سازگار با دانش-صفر بسازند.

## کارمزد رول‌آپ های دانش-صفر چگونه است؟ {#how-do-zk-rollup-fees-work}

میزان پرداختی که کاربران برای تراکنش‌های روی رول‌آپ های دانش-صفر پرداخت می‌کنند، دقیقاً مانند شبکه اصلی اتریوم، به کارمزد گاز بستگی دارد. با این حال، هزینه های گاز در لایه دو ها متفاوت عمل می‌کند و تحت تأثیر هزینه‌های زیر می‌باشد:

1. **بازنویسی حالت**: برای نوشتن در حالت اتریوم هزینه ثابتی وجود دارد (یعنی ارسال تراکنش در بلاک چین اتریوم). رول‌آپ های دانش-صفر این هزینه را با دسته‌بندی تراکنش‌ها و توزیع هزینه‌های ثابت بین چندین کاربر کاهش می‌دهند.

2. **انتشار داده‌ها**: رول‌آپ های دانش-صفر داده‌های حالت هر تراکنش را به عنوان `calldata` در اتریوم منتشر می‌کنند. هزینه‌های `calldata` در حال حاضر توسط [EIP-1559](https://eips.ethereum.org/EIPS/eip-1559) کنترل می‌شود که به ترتیب هزینه 16 گاز را برای بایت‌های غیر صفر و 4 گاز را برای بایت‌های صفر موجود در `calldata` را تعیین می‌کند. هزینه پرداخت شده برای هر تراکنش به حجم `calldata` ارسالی در زنجیره اصلی، بستگی دارد.

3. **کارمزدهای اپراتور L2**: این مبلغی است که به عنوان جبران هزینه‌های محاسباتی انجام شده در پردازش تراکنش‌ها، به اپراتور رول‌‌آپ پرداخت می‌شود، خیلی شبیه به ["هزینه‌های اولویت (پاداش‌ها)" تراکنش](/developers/docs/gas/#how-are-gas-fees-calculated) در شبکه اصلی اتریوم.

4. **تولید گواهی اثبات و تائید آن**: اپراتورهای رول‌آپ دانش-صفر، باید برای دسته‌های تراکنش اثبات ادعا ارائه کنند که نیازمند منابع زیادی است. همچنین، تأیید گواهی‌های دانش-صفر در شبکه اصلی اتریوم گاز (حدود 500,000 واحد گاز) مصرف می‌کند.

جدا از دسته کردن تراکنش‌ها، رول‌آپ های دانش-صفر با فشرده‌سازی داده‌های تراکنش، هزینه‌ها را برای کاربران کاهش می‌دهند. می‌توانید [نمای کلی به روز](https://l2fees.info/) از هزینه‌های استفاده از رول‌آپ دانش-صفر اتریوم را ببینید.

## رول‌آپ دانش-صفر چگونه اتریوم را مقیاس‌پذیر می کنند؟ {#scaling-ethereum-with-zk-rollups}

### فشرده‌سازی داده‌های تراکنش {#transaction-data-compression}

رول‌آپ های دانش-صفر با استفاده از محاسبات خارج از زنجیره، توان عملیاتی و تعداد داده‌های ورودی لایه پایه اتریوم را افزایش می‌دهند، اما تقویت واقعی مقیاس‌پذیری از فشرده‌سازی داده های تراکنش حاصل می‌شود. [اندازه بلوک](/developers/docs/blocks/#block-size) اتریوم داده‌هایی را که هر بلوک می‌تواند نگه دارد و در نتیجه تعداد تراکنش‌های پردازش شده در هر بلوک را محدود می‌کند. با فشرده‌سازی داده های مربوط به تراکنش، رول‌آپ های دانش-صفر به طور قابل توجهی تعداد تراکنش های پردازش شده در هر بلوک را افزایش می‌دهند.

رول‌آپ های دانش-صفر می‌توانند داده‌های تراکنش را بهتر از رول‌آپ های خوش‌بینانه فشرده کنند، زیرا نیازی به ارسال تمام داده‌های مورد نیاز برای اعتبارسنجی هر تراکنش ندارند. آنها فقط باید حداقل داده های مورد نیاز برای بازسازی آخرین حالت حساب‌ها و موجودی‌ها را در رول‌‌آپ ارسال نمایند.

### اثبات های بازگشتی {#recursive-proofs}

مزیت اثبات‌های دانش-صفر این است که گواهی‌ها می‌توانند گواهی‌های دیگر را تأیید کنند. به عنوان مثال، یک ZK-SNARK می‌تواند یک ZK-SNARK دیگر را تأیید کند. چنین گواهی‌های بازگشتی را "اثباتِ اثبات" می‌نامند و به طور چشمگیری توان عملیاتی را در رول‌آپ های دانش-صفر افزایش می‌دهند.

در حال حاضر، گواهی‌های اعتبار به صورت بلوک به بلوک تولید می‌شوند و برای تائید به قرارداد مستقر بر اتریوم ارسال می‌شوند. با این حال، تأیید گواهی‌های تک بلوکی، توان عملیاتی که رول‌آپ های دانش-صفر می‌توانند به دست آورند را محدود می‌کند، زیرا زمانی که اپراتور یک گواهی را ارائه و ثبت می‌کند، تنها یک بلوک نهایی می‌شود.

در عوض، گواهی‌های بازگشتی، نهایی کردن چندین بلوک را با یک گواهی اعتبار امکان‌پذیر می‌کنند. این به این دلیل است که مدار اثبات به صورت بازگشتی چندین گواهی بلوک را دست‌چین می‌کند تا زمانی که یک اثبات نهایی ایجاد شود. اپراتور لایه دو این گواهی بازگشتی را ارسال می‌کند و در صورت پذیرش توسط قرارداد، تمام بلوک های مربوطه بلافاصله نهایی می‌شوند. با گواهی‌های بازگشتی، تعداد تراکنش‌های رول‌آپ دانش-صفر که می‌توانند در اتریوم در فواصل زمانی مشخص نهایی شوند، افزایش می‌یابند.

### مزایا و معایب رول‌آپ دانش-صفر {#zk-rollups-pros-and-cons}

| مزایا                                                                                                                                                                                                         | معایب                                                                                                                                                                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| گواهی اثبات اعتبار صحت تراکنش‌های خارج از زنجیره را تضمین می‌کند و از اجرای انتقال حالت نامعتبر توسط اپراتورها جلوگیری می‌کند.                                                                                | هزینه مربوط به محاسبات و تأیید اثبات اعتبار قابل توجه است و می تواند هزینه‌ها را برای کاربران رول‌‌آپ افزایش دهد.                                                                                |
| نهایی شدن تراکنش سریع‌تر را ارائه می‌دهد، زیرا به محض تأیید اعتبار گواهی در شبکه اصلی اتریوم، به‌روزرسانی‌های حالت تأیید می‌شوند.                                                                             | ایجاد رول‌آپ های دانش-صفر سازگار با EVM به دلیل پیچیدگی فناوری دانش-صفر دشوار است.                                                                                                               |
| برای امنیت به مکانیسم‌های رمزنگاری بدون نیاز به اعتماد متکی است، نه صداقت مشارکت‌کنندگانی که ذی‌نفع هستند مثل [رول آپ‌های خوش‌بینانه](/developers/docs/scaling/optimistic-rollups/#optimistic-pros-and-cons). | تولید گواهی اثبات اعتبار نیاز به سخت‌افزار تخصصی دارد که ممکن است مشوقی برای کنترل متمرکز زنجیره توسط چند نهاد باشد.                                                                             |
| داده های مورد نیاز برای بازیابی حالت خارج از زنجیره را در L1 ذخیره می کند، که امنیت، مقاومت در برابر سانسور و عدم تمرکز را تضمین می‌کند.                                                                      | اپراتورهای متمرکز (sequencer یا ترتیب‌دهنده ها) می‌توانند بر ترتیب تراکنش‌ها تأثیر بگذارند.                                                                                                      |
| کاربران از بهره‌وری بیشتر سرمایه بهره می‌برند و می‌توانند بدون تاخیر وجوه را از L2 برداشت نمایند.                                                                                                             | الزامات سخت‌افزاری ممکن است تعداد شرکت‌کنندگان زنجیره را کاهش دهد که می‌تواند زنجیره را مجبور به تغییر کند و خطر مسدود کردن حالت رول‌‌آپ توسط اپراتورهای مخرب و سانسور کاربران را افزایش می‌دهد. |
| به فرضیات در حال اجرا بودن بستگی ندارد و کاربران مجبور نیستند زنجیره را برای محافظت از سرمایه خود تأیید کنند.                                                                                                 | برخی از سیستم‌های اثبات‌کننده (مانند ZK-SNARK) به تنظیمات قابل اعتماد نیاز دارند که در صورت عدم مدیریت صحیح، به طور بالقوه می‌تواند مدل امنیتی رول‌آپ دانش-صفر را به خطر بیندازد.                |
| فشرده‌سازی بهتر داده‌ها می‌تواند به کاهش هزینه‌های انتشار `calldata` در اتریوم و به حداقل رساندن هزینه‌های رول‌‌آپ برای کاربران کمک کند.                                                                      |                                                                                                                                                                                                  |

### توضیح تصویری از رول‌آپ های دانش-صفر {#zk-video}

ببینید Finematics چگونه درباره رول‌آپ دانش-صفر توضیح می‌دهد:

<YouTube id="7pWxCklcNsU" start="406" />

### استفاده از رول‌آپ های دانش-صفر {#use-zk-rollups}

پیاده سازی های متعددی از رول‌آپ های دانش-صفر وجود دارد که می‌توانید آنها را در dappهای خود ادغام کنید:

<RollupProductDevDoc rollupType="zk" />

## چه کسی روی zkEVM کار می‌کند؟ {#zkevm-projects}

پروژه هایی که روی zkEVM کار می کنند عبارتند از:

- **[zkEVM](https://github.com/privacy-scaling-explorations/zkevm-specs)** - _zkEVM پروژه‌ای است که توسط بنیاد اتریوم برای توسعه یک رول‌آپ دانش-صفر سازگار با EVM و مکانیزمی برای تولید گواهی اثبات اعتبار برای بلوک‌های اتریوم، بنیان‌گذاری شد._

- **[Polygon zkEVM](https://polygon.technology/solutions/polygon-zkevm)** - _یک رول‌آپ غیرمتمرکز دانش-صفر در شبکه اصلی اتریوم است که بر روی یک ماشین مجازی اتریوم با دانش صفر (zkEVM) کار می کند که تراکنش های اتریوم را به روشی شفاف اجرا می کند، از جمله قراردادهای هوشمند با اعتبارسنجی دانش-صفر._

- **[Scroll](https://scroll.io/blog/zkEVM)** - _Scroll یک شرکت مبتنی بر فناوری است که بر روی ساخت یک راه حل بومی zkEVM Layer 2 برای اتریوم کار می‌کند._

- **[Taiko](https://taiko.xyz)** - _Taiko یک رول‌آپ دانش-صفر غیرمتمرکز و معادل اتریوم است (یک [ZK-EVM نوع 1](https://vitalik.eth.limo/general/2022/08/04/zkevm.html))._

- **[ZKsync](https://docs.zksync.io/)** - _ZKsync Era یک رول‌آپ دانش-صفر سازگار با EVM است که توسط Matter Labs ساخته شده است و با استفاده از zkEVM خودش اجرا می‌شود._

- **[Starknet](https://starkware.co/starknet/)** - _StarkNet یک راه حل مقیاس پذیری لایه 2 سازگار با EVM است که توسط StarkWare ساخته شده است._

- **[Morph](https://www.morphl2.io/)** - _Morph یک راه‌حل مقیاس‌پذیری ترکیبی است که از گواهی دانش-صفر برای رسیدگی به مشکل چالش حالت لایه 2 استفاده می‌کند._

## خواندنی‌های بیشتر در مورد رول‌آپ های دانش-صفر {#further-reading-on-zk-rollups}

- [رول‌آپ دانش-صفر چیست؟](https://coinmarketcap.com/alexandria/glossary/zero-knowledge-rollups)
- [رول‌آپ دانش-صفر چیست؟](https://alchemy.com/blog/zero-knowledge-rollups)
- [STARKها در مقابل SNARKها](https://consensys.net/blog/blockchain-explained/zero-knowledge-proofs-starks-vs-snarks/)
- [ZkEVM چیست؟](https://www.alchemy.com/overviews/zkevm)
- [انواع ZK-EVM: معادل اتریوم، معادل ماشین مجازی اتریوم، نوع 1، نوع 4، و دیگر واژه‌های مرموز](https://taiko.mirror.xyz/j6KgY8zbGTlTnHRFGW6ZLVPuT0IV0_KmgowgStpA0K4)
- [معرفی zkEVM](https://hackmd.io/@yezhang/S1_KMMbGt)
- [منابع عالی zkEVM](https://github.com/LuozhuZhang/awesome-zkevm)
- [پشت صحنه ZK-SNARKS](https://vitalik.eth.limo/general/2017/02/01/zk_snarks.html)
- [SNARK چگونه ممکن است؟](https://vitalik.eth.limo/general/2021/01/26/snarks.html)
